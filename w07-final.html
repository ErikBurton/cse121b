<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <title>My Weather Forecast App</title>
</head>
<body>
<div class="container">
    <div id="app">
        <h1>Weather Forecast</h1>
        <div>
            <label for="zipCodeInput">Enter Zip Code: </label>
            <input type="text" id="zipCodeInput">
            <button id="getWeatherButton">Get Weather</button>
        </div>
    </div>

    <script type="module">
        // Import the 'fetchWeather' function from the 'w07-final.js module'.
        import { fetchWeather } from './w07-final.js';

        // const zipCodeInput = document.getElementById('zipCodeInput');
        const latInput = document.getElementById('latitude');
        const longInput = document.getElementById('longitude');
        const searchButton = document.getElementById('searchButton');
        const errorDiv = document.getElementById('error');
        const weatherDiv = document.getElementById('weather');

        // Add event listener to the "Seach" button
        searchButton.addEventListener('click', () => 
        {
            const zipCode = zipCodeInput.value;
            if (zipCode) 
            {
            // Call "fetchWeather" function with the user's input
            fetchWeather(zipCode)
            .then((weatherData) =>
            {
                // Display the weather data if fetch is successful
                displayWeather(weatherData);
                errorDiv.textContent = '';
            })
            .catch((error) => 
            {
                // Handle any errors and display message
                {
                    errorDiv.textContent = error;
                    weatherDiv.innerHTML = '';
                }
            }); 
            } else
            {
                errorDiv.textContent = "Please enter a ZIP Code!";
                weatherDiv.innerHTML = '';
            }
        }); 

            // Display the forecast using dynamic templates
            function displayWeather(data)
            {
                const { city, forecast } = data;
                const template = `
                <h2>Weather in ${city}</h2>
                <ul>
                    ${forecast}
                        .map((day) => '<li>${day.date}: ${day.weather}</li>')
                        .join(' ')}
                </ul>
            `;
            weatherDiv.innerHTML = template;
            }
    </script>    
</body>
</html>